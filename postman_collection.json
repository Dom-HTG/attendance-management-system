{
  "info": {
    "_postman_id": "attendance-management-complete",
    "name": "Attendance Management System - Complete",
    "description": "Complete Attendance Management System with Authentication and QR Code Features",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:2754",
      "type": "string"
    },
    {
      "key": "student_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "lecturer_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "event_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "qr_token",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "AUTH - Authentication Endpoints",
      "item": [
        {
          "name": "1. Student Registration",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"email\": \"john.doe@student.edu\",\n  \"password\": \"securePassword123\",\n  \"matric_number\": \"STU-2024-001\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register-student",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "register-student"]
            },
            "description": "Register a new student account. Required fields: first_name, last_name, email, password, matric_number"
          },
          "response": []
        },
        {
          "name": "2. Lecturer Registration",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"first_name\": \"Jane\",\n  \"last_name\": \"Smith\",\n  \"email\": \"jane.smith@lecturer.edu\",\n  \"password\": \"securePassword123\",\n  \"department\": \"Computer Science\",\n  \"staff_id\": \"STAFF-2024-001\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register-lecturer",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "register-lecturer"]
            },
            "description": "Register a new lecturer account. Required fields: first_name, last_name, email, password, department, staff_id"
          },
          "response": []
        },
        {
          "name": "3. Student Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('student_token', jsonData.token);",
                  "    console.log('Student token saved: ' + jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@student.edu\",\n  \"password\": \"securePassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login-student",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "login-student"]
            },
            "description": "Login as a student. Returns JWT token that should be used in subsequent requests."
          },
          "response": []
        },
        {
          "name": "4. Lecturer Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('lecturer_token', jsonData.token);",
                  "    console.log('Lecturer token saved: ' + jsonData.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"jane.smith@lecturer.edu\",\n  \"password\": \"securePassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login-lecturer",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "login-lecturer"]
            },
            "description": "Login as a lecturer. Returns JWT token that should be used in subsequent requests."
          },
          "response": []
        }
      ]
    },
    {
      "name": "QR CODE - Lecturer Endpoints",
      "item": [
        {
          "name": "5. Generate QR Code for Event",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.environment.set('event_id', jsonData.event_id);",
                  "    pm.environment.set('qr_token', jsonData.qr_token);",
                  "    console.log('Event ID saved: ' + jsonData.event_id);",
                  "    console.log('QR Token saved: ' + jsonData.qr_token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{lecturer_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"course_name\": \"Introduction to Programming\",\n  \"course_code\": \"CS101\",\n  \"department\": \"Computer Science\",\n  \"venue\": \"Room 201, Engineering Block\",\n  \"start_time\": \"2025-11-28T10:00:00Z\",\n  \"end_time\": \"2025-11-28T11:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/lecturer/qrcode/generate",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "lecturer", "qrcode", "generate"]
            },
            "description": "Generate a QR code for an attendance event. Only lecturers can access this endpoint. Returns QR code as base64 PNG image."
          },
          "response": []
        }
      ]
    },
    {
      "name": "ATTENDANCE - Student Endpoints",
      "item": [
        {
          "name": "6. Check-In (Scan QR Code)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{student_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qr_token\": \"{{qr_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/attendance/check-in",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "attendance", "check-in"]
            },
            "description": "Student checks in by scanning QR code. The qr_token must be valid and within the event time window."
          },
          "response": []
        },
        {
          "name": "7. Get Student Attendance Records",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{student_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/attendance/student/records",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "attendance", "student", "records"]
            },
            "description": "Retrieve all attendance records for the authenticated student. Shows all events they checked in for."
          },
          "response": []
        }
      ]
    },
    {
      "name": "ATTENDANCE - Lecturer Endpoints",
      "item": [
        {
          "name": "8. Get Event Attendance Records",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{lecturer_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/attendance/{{event_id}}",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "attendance", "{{event_id}}"]
            },
            "description": "Retrieve all attendance records for a specific event. Only lecturers can access this. Shows all students who checked in."
          },
          "response": []
        }
      ]
    },
    {
      "name": "ERROR TESTS - Validation & Security",
      "item": [
        {
          "name": "E1. Missing Required Fields",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/register-student",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "register-student"]
            },
            "description": "Expected: 400 Bad Request - Test validation of required fields"
          },
          "response": []
        },
        {
          "name": "E2. Wrong Password on Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@student.edu\",\n  \"password\": \"wrongPassword\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login-student",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "auth", "login-student"]
            },
            "description": "Expected: 401 Unauthorized - Test login with incorrect password"
          },
          "response": []
        },
        {
          "name": "E3. Access Protected Route Without Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"course_name\": \"Test Course\",\n  \"course_code\": \"TEST101\",\n  \"department\": \"Testing\",\n  \"venue\": \"Test Room\",\n  \"start_time\": \"2025-11-28T10:00:00Z\",\n  \"end_time\": \"2025-11-28T11:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/lecturer/qrcode/generate",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "lecturer", "qrcode", "generate"]
            },
            "description": "Expected: 401 Unauthorized - Test attempting to access protected route without authentication token"
          },
          "response": []
        },
        {
          "name": "E4. Student Cannot Generate QR Code",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{student_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"course_name\": \"Test Course\",\n  \"course_code\": \"TEST101\",\n  \"department\": \"Testing\",\n  \"venue\": \"Test Room\",\n  \"start_time\": \"2025-11-28T10:00:00Z\",\n  \"end_time\": \"2025-11-28T11:00:00Z\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/lecturer/qrcode/generate",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "lecturer", "qrcode", "generate"]
            },
            "description": "Expected: 403 Forbidden - Test role-based access control (student cannot generate QR codes)"
          },
          "response": []
        },
        {
          "name": "E5. Invalid QR Token on Check-In",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{student_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qr_token\": \"\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/attendance/check-in",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "attendance", "check-in"]
            },
            "description": "Expected: 400 Bad Request - Test validation of QR token"
          },
          "response": []
        },
        {
          "name": "E6. Duplicate Check-In Attempt",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{student_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qr_token\": \"{{qr_token}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/attendance/check-in",
              "protocol": "http",
              "host": ["localhost"],
              "port": "2754",
              "path": ["api", "attendance", "check-in"]
            },
            "description": "Expected: 409 Conflict - Test attempting to check in twice for the same event"
          },
          "response": []
        }
      ]
    }
  ]
}
